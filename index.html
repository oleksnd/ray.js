<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RAY.js Playground</title>
    <style>
      :root {
        --bg: #ffffff;
        --fg: #1a1a1a;
        --accent: #1a1a1a;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        color: var(--fg);
        font-family: "Courier New", Courier, monospace;
        overflow: hidden;
      }

      .hud {
        position: fixed;
        top: 16px;
        left: 18px;
        z-index: 2;
        font-size: 14px;
        letter-spacing: 4px;
        color: var(--accent);
        user-select: none;
      }
    </style>
  </head>
  <body>
    <div class="hud">RAY // ACTIVE</div>
    <script src="./ray.js"></script>
    <script>
      ray.init({ background: "#ffffff" });

      let width = window.innerWidth;
      let height = window.innerHeight;
      let progress = 0;
      let prevX = null;
      let prevY = null;

      const resetStroke = () => {
        ray.cls("#ffffff");
        progress = 0;
        prevX = null;
        prevY = null;
      };

      const updateSize = () => {
        const size = ray.size();
        width = size.width;
        height = size.height;
        resetStroke();
      };

      window.addEventListener("resize", updateSize, { passive: true });

      ray.demoStroke = () => {
        updateSize();
        resetStroke();
        ray.loop((time, delta) => {
          const dt = delta / 1000;
          progress += dt * 0.22;
          if (progress > 1) {
            resetStroke();
            return;
          }

          const p = progress;
          const startX = width * 0.18;
          const endX = width * 0.82;
          const x =
            startX +
            (endX - startX) * p +
            Math.sin(p * Math.PI * 2) * width * 0.035;
          const centerY = height * 0.5;
          const y =
            centerY +
            Math.sin(p * Math.PI * 2) * height * 0.16 +
            Math.sin(p * Math.PI) * height * 0.05;

          if (prevX == null || prevY == null) {
            prevX = x;
            prevY = y;
            return;
          }

          const pressure = Math.max(0.08, 0.95 - p * 0.85);
          ray.brush(x, y, prevX, prevY, pressure);
          prevX = x;
          prevY = y;
        });
      };

      ray.demoStroke();
    </script>
  </body>
</html>
